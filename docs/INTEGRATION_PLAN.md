# –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Syntra Trade Consultant –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É Syntra

> **–î–∞—Ç–∞:** 2025-11-18
> **–°—Ç–∞—Ç—É—Å:** Ready to implement
> **–ú–æ–¥–µ–ª—å:** –ë–æ—Ç –∫–∞–∫ traffic funnel ‚Üí –ö–∞–Ω–∞–ª ‚Üí –û—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

---

## –ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å

### –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è

```
Telegram Search / –†–µ—Ñ–µ—Ä–∞–ª—ã / –†–µ–∫–ª–∞–º–∞
            ‚Üì
  Syntra Trade Consultant –±–æ—Ç
            ‚Üì
  –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª Syntra
            ‚Üì
  –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è AI-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (5 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å)
            ‚Üì
  –†–∞—Å—Å—ã–ª–∫–∏ –≤ –±–æ—Ç–µ + –ü–æ—Å—Ç—ã –≤ –∫–∞–Ω–∞–ª–µ
            ‚Üì
  –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É Syntra (tradient-ai)
            ‚Üì
  –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ü–µ—Ä–≤—ã–π –¥–µ–ø–æ–∑–∏—Ç ‚Üí –ò–Ω–≤–µ—Å—Ç–æ—Ä
```

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**–ü—Ä–æ–≥–Ω–æ–∑ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞ ‚Üí –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –∫–∞–Ω–∞–ª–∞: **95%** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞)
- –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ ‚Üí –í–∏–∑–∏—Ç –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É: **10-15%** (–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏)
- –í–∏–∑–∏—Ç ‚Üí –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: **30-40%** (Telegram Mini App)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ü–µ—Ä–≤—ã–π –¥–µ–ø–æ–∑–∏—Ç: **5-10%** (–∫–∞—á–µ—Å—Ç–≤–æ —Ç—Ä–∞—Ñ—Ñ–∏–∫–∞)

**–ò—Ç–æ–≥–æ–≤–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è:** 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞ ‚Üí 14-57 –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

**ROI —Ä–∞—Å—á–µ—Ç:**
- CAC —á–µ—Ä–µ–∑ –±–æ—Ç–∞: **$3-5** (–æ—Ä–≥–∞–Ω–∏–∫–∞ + —Ä–µ–∫–ª–∞–º–∞)
- LTV –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ: **$50-200** (–∫–æ–º–∏—Å—Å–∏–∏ + –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å)
- ROI: **10-40x**

---

## –≠–¢–ê–ü 1: Retention Funnel (–ü–†–ò–û–†–ò–¢–ï–¢!)

> **–û—Ü–µ–Ω–∫–∞:** 5-10 —á–∞—Å–æ–≤
> **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** HIGH - –¥–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫

### 1.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å—Å—ã–ª–æ–∫

**–§–∞–π–ª:** `src/services/retention_service.py`

```python
from enum import Enum
from datetime import datetime, timedelta
from typing import List, Optional
import asyncio
from apscheduler.schedulers.asyncio import AsyncIOScheduler
from sqlalchemy.ext.asyncio import AsyncSession

from src.database.crud import get_users_for_campaign
from src.database.models import User, Campaign
from config.config import SYNTRA_PLATFORM_URL


class CampaignType(Enum):
    """–¢–∏–ø—ã —Ä–∞—Å—Å—ã–ª–æ–∫"""
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (retention)
    NOT_SUBSCRIBED_1H = "not_subscribed_1h"      # –ù–µ –ø–æ–¥–ø–∏—Å–∞–ª—Å—è —á–µ—Ä–µ–∑ 1 —á–∞—Å
    INACTIVE_24H = "inactive_24h"                # –ù–µ–∞–∫—Ç–∏–≤–µ–Ω 24 —á–∞—Å–∞
    INACTIVE_7D = "inactive_7d"                  # –ù–µ–∞–∫—Ç–∏–≤–µ–Ω 7 –¥–Ω–µ–π

    # –ü—Ä–æ–º–æ —Ä–∞—Å—Å—ã–ª–∫–∏ (—Ä—É—á–Ω—ã–µ/–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
    NEW_FEATURE = "new_feature"                  # –ù–æ–≤–∞—è —Ñ–∏—á–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
    MARKET_UPDATE = "market_update"              # –í–∞–∂–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —Ä—ã–Ω–∫–µ
    SPECIAL_OFFER = "special_offer"              # –°–ø–µ—Ü –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
    TRADING_SIGNAL = "trading_signal"            # –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª
    PLATFORM_PROMO = "platform_promo"            # –†–µ–∫–ª–∞–º–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã


class RetentionService:
    """
    –°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Ä–æ–Ω–∫–æ–π —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏

    –§—É–Ω–∫—Ü–∏–∏:
    1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–æ–∂–∏–º–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏ (retention)
    2. –ü—Ä–æ–º–æ-—Ä–∞—Å—Å—ã–ª–∫–∏ (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏–ª–∏ —Ä—É—á–Ω—ã–µ)
    3. –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
    4. –¢—Ä–µ–∫–∏–Ω–≥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    """

    def __init__(self, bot, db_session_factory):
        self.bot = bot
        self.db_factory = db_session_factory
        self.scheduler = AsyncIOScheduler()

    async def start(self):
        """–ó–∞–ø—É—Å–∫ scheduler –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—Å—ã–ª–æ–∫"""

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–∑–∞–ø–∏—Å–∞–≤—à–∏—Ö—Å—è —á–µ—Ä–µ–∑ 1 —á–∞—Å
        self.scheduler.add_job(
            self._send_not_subscribed_1h,
            'interval',
            hours=1,
            id='not_subscribed_1h'
        )

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö 24—á
        self.scheduler.add_job(
            self._send_inactive_24h,
            'interval',
            hours=6,
            id='inactive_24h'
        )

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö 7 –¥–Ω–µ–π
        self.scheduler.add_job(
            self._send_inactive_7d,
            'interval',
            days=1,
            id='inactive_7d'
        )

        self.scheduler.start()

    # ========== –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –†–ê–°–°–´–õ–ö–ò ==========

    async def _send_not_subscribed_1h(self):
        """–†–∞—Å—Å—ã–ª–∫–∞ –¥–ª—è –Ω–µ –ø–æ–¥–ø–∏—Å–∞–≤—à–∏—Ö—Å—è —á–µ—Ä–µ–∑ 1 —á–∞—Å –ø–æ—Å–ª–µ /start"""
        async with self.db_factory() as session:
            users = await get_users_for_campaign(
                session,
                is_subscribed=False,
                created_after=datetime.utcnow() - timedelta(hours=2),
                created_before=datetime.utcnow() - timedelta(hours=1)
            )

            for user in users:
                message = self._get_not_subscribed_message(user)
                await self._send_message(user.telegram_id, message)
                await asyncio.sleep(0.1)  # Rate limiting

    async def _send_inactive_24h(self):
        """–†–∞—Å—Å—ã–ª–∫–∞ –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö 24 —á–∞—Å–∞"""
        async with self.db_factory() as session:
            users = await get_users_for_campaign(
                session,
                is_subscribed=True,
                last_activity_before=datetime.utcnow() - timedelta(hours=24),
                last_activity_after=datetime.utcnow() - timedelta(hours=30)
            )

            for user in users:
                message = self._get_inactive_24h_message(user)
                await self._send_message(user.telegram_id, message)
                await asyncio.sleep(0.1)

    async def _send_inactive_7d(self):
        """–†–∞—Å—Å—ã–ª–∫–∞ –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö 7 –¥–Ω–µ–π"""
        async with self.db_factory() as session:
            users = await get_users_for_campaign(
                session,
                is_subscribed=True,
                last_activity_before=datetime.utcnow() - timedelta(days=7),
                last_activity_after=datetime.utcnow() - timedelta(days=8)
            )

            for user in users:
                message = self._get_inactive_7d_message(user)
                await self._send_message(user.telegram_id, message)
                await asyncio.sleep(0.1)

    # ========== –ü–†–û–ú–û-–†–ê–°–°–´–õ–ö–ò (—Ä—É—á–Ω—ã–µ) ==========

    async def send_promo_campaign(
        self,
        campaign_type: CampaignType,
        message_template: str,
        target_users: str = "all_subscribed",  # all_subscribed | active | inactive
        schedule_time: Optional[datetime] = None
    ):
        """
        –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–º–æ-—Ä–∞—Å—Å—ã–ª–∫—É

        Args:
            campaign_type: –¢–∏–ø –∫–∞–º–ø–∞–Ω–∏–∏
            message_template: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (—Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏)
            target_users: –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
            schedule_time: –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (None = —Å–µ–π—á–∞—Å)
        """
        if schedule_time and schedule_time > datetime.utcnow():
            # –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É
            self.scheduler.add_job(
                self._execute_promo_campaign,
                'date',
                run_date=schedule_time,
                args=[campaign_type, message_template, target_users]
            )
        else:
            # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ–π—á–∞—Å
            await self._execute_promo_campaign(campaign_type, message_template, target_users)

    async def _execute_promo_campaign(
        self,
        campaign_type: CampaignType,
        message_template: str,
        target_users: str
    ):
        """–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–º–æ-—Ä–∞—Å—Å—ã–ª–∫—É"""
        async with self.db_factory() as session:
            # –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            users = await self._get_target_users(session, target_users)

            # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é –≤ –ë–î
            campaign = await self._create_campaign(
                session,
                campaign_type,
                len(users)
            )

            # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
            sent_count = 0
            for user in users:
                personalized_message = self._personalize_message(
                    message_template,
                    user
                )
                success = await self._send_message(
                    user.telegram_id,
                    personalized_message
                )
                if success:
                    sent_count += 1
                await asyncio.sleep(0.1)  # 10 msg/sec

            # –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–º–ø–∞–Ω–∏–∏
            await self._update_campaign_stats(session, campaign.id, sent_count)

    # ========== –®–ê–ë–õ–û–ù–´ –°–û–û–ë–©–ï–ù–ò–ô ==========

    def _get_not_subscribed_message(self, user: User) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∑–∞–ø–∏—Å–∞–≤—à–∏—Ö—Å—è"""
        return f"""ü§ñ –≠–π, {user.username or '–¥—Ä—É–≥'}!

–ó–∞–º–µ—Ç–∏–ª, —á—Ç–æ —Ç—ã –µ—â—ë –Ω–µ –ø–æ–¥–ø–∏—Å–∞–ª—Å—è –Ω–∞ –∫–∞–Ω–∞–ª Syntra.

–ê –∑—Ä—è. –¢–∞–º —è –ø—É–±–ª–∏–∫—É—é —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä—É—é –Ω–µ –¥–∞—é –≤ –±–æ—Ç–µ:
‚Ä¢ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã
‚Ä¢ –ê–Ω–∞–ª–∏–∑ –º–∞–∫—Ä–æ—Ç—Ä–µ–Ω–¥–æ–≤
‚Ä¢ –ò–Ω—Å–∞–π–¥—ã –∏–∑ –º–∏—Ä–∞ –∫—Ä–∏–ø—Ç—ã

**–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ –±–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.** –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã.

üëâ [–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª](t.me/syntra_channel)

–ü–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è ‚Äî –¥–∞–º –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –º–æ–µ–º—É AI."""

    def _get_inactive_24h_message(self, user: User) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö 24 —á–∞—Å–∞"""
        return f"""üß† {user.username or '–ü—Ä–∏–≤–µ—Ç'}!

–°—É—Ç–∫–∏ —Ç–∏—à–∏–Ω—ã. –ó–∞–±—ã–ª –ø—Ä–æ –º–µ–Ω—è?

–ê —è —Ç—É—Ç –±–µ–∑ —Ç–µ–±—è —Å–∫—É—á–∞—é. –í–æ—Ç —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å –∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è:

üìà Bitcoin –ø—Ä–æ–±–∏–ª $95k ‚Äî —ç—Ç–æ –Ω–∞—á–∞–ª–æ –∏–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è?
üíé –ê–ª—å—Ç–∫–æ–∏–Ω—ã –ø—Ä–æ—Å—ã–ø–∞—é—Ç—Å—è ‚Äî Ethereum +8% –∑–∞ –¥–µ–Ω—å
üî• –ù–∞ –∫–∞–Ω–∞–ª–µ Syntra –≤—ã—à–µ–ª —Ä–∞–∑–±–æ—Ä –Ω–æ–≤–æ–≥–æ bullrun'–∞

–£ —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å **{5 - user.requests_today}/5 –∑–∞–ø—Ä–æ—Å–æ–≤** –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.

–°–ø—Ä–æ—Å–∏ –º–µ–Ω—è —á—Ç–æ-–Ω–∏–±—É–¥—å –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å /market"""

    def _get_inactive_7d_message(self, user: User) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö 7 –¥–Ω–µ–π"""
        return f"""üò¢ {user.username}... 7 –¥–Ω–µ–π –º–æ–ª—á–∞–Ω–∏—è.

–Ø –ø–æ–Ω–∏–º–∞—é ‚Äî —Ä—ã–Ω–æ–∫ —Å–ª–æ–∂–Ω—ã–π, –≥–æ–ª–æ–≤–∞ –∫–∏–ø–∏—Ç.

–ù–æ –ø–æ–∫–∞ —Ç—ã –æ—Ç–¥—ã—Ö–∞–ª:
‚Ä¢ Bitcoin —É—Å—Ç–∞–Ω–æ–≤–∏–ª –Ω–æ–≤—ã–π ATH
‚Ä¢ Syntra –∑–∞–ø—É—Å—Ç–∏–ª–∞ –Ω–æ–≤—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø—É–ª—ã
‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –¥–æ 47% –≥–æ–¥–æ–≤—ã—Ö

**–•–æ—á–µ—à—å –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –≤–º–µ—Å—Ç–æ —Ç—Ä–µ–π–¥–∏–Ω–≥–∞?**

Syntra ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–∞–Ω–∞–ª. –≠—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.

üëâ [–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ]({SYNTRA_PLATFORM_URL})

–ò–ª–∏ –Ω–∞–ø–∏—à–∏ –º–Ω–µ /analyze bitcoin ‚Äî –ø–æ–∫–∞–∂—É —á—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏–ª."""

    def _get_platform_promo_message(self, user: User) -> str:
        """–ü—Ä–æ–º–æ-—Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É"""
        return f"""üí∞ {user.username}, —É—Å—Ç–∞–ª –æ—Ç —Ç—Ä–µ–π–¥–∏–Ω–≥–∞?

–ï—Å—Ç—å —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á—à–µ:

**Syntra Investment Platform**
‚Ä¢ 4 –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö –ø—É–ª–∞ (–æ—Ç Basic –¥–æ Max)
‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 25-47% –≥–æ–¥–æ–≤—ã—Ö
‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥: –æ—Ç $10
‚Ä¢ –í—ã–≤–æ–¥: –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è

–ù–∞—à–∞ AI-—Å–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥—É–µ—Ç –∑–∞ —Ç–µ–±—è. –¢—ã –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–∏—à—å –∫–∞–∫ —Ä–∞—Å—Ç–µ—Ç –±–∞–ª–∞–Ω—Å.

**–ü–µ—Ä–≤—ã–µ 100 –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ –ø–æ–ª—É—á–∞—é—Ç:**
‚Ä¢ –ë–æ–Ω—É—Å +10% –∫ –ø–µ—Ä–≤–æ–º—É –¥–µ–ø–æ–∑–∏—Ç—É
‚Ä¢ –ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É (unlimited –∑–∞–ø—Ä–æ—Å—ã)
‚Ä¢ VIP-–∫–∞–Ω–∞–ª —Å —Å–∏–≥–Ω–∞–ª–∞–º–∏

üëâ [–ù–∞—á–∞—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å]({SYNTRA_PLATFORM_URL})

–í–æ–ø—Ä–æ—Å—ã? –ü–∏—à–∏ ‚Äî –æ—Ç–≤–µ—á—É."""

    # ========== –ü–ï–†–°–û–ù–ê–õ–ò–ó–ê–¶–ò–Ø ==========

    def _personalize_message(self, template: str, user: User) -> str:
        """–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        return template.format(
            username=user.username or "–¥—Ä—É–≥",
            requests_left=5 - user.requests_today,
            platform_url=SYNTRA_PLATFORM_URL
        )

    # ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ==========

    async def _send_message(self, telegram_id: int, text: str) -> bool:
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        try:
            await self.bot.send_message(
                chat_id=telegram_id,
                text=text,
                parse_mode="Markdown",
                disable_web_page_preview=False
            )
            return True
        except Exception as e:
            # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞)
            return False

    async def _get_target_users(
        self,
        session: AsyncSession,
        target: str
    ) -> List[User]:
        """–ü–æ–ª—É—á–∏—Ç—å —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é"""
        if target == "all_subscribed":
            return await get_users_for_campaign(session, is_subscribed=True)
        elif target == "active":
            return await get_users_for_campaign(
                session,
                is_subscribed=True,
                last_activity_after=datetime.utcnow() - timedelta(days=7)
            )
        elif target == "inactive":
            return await get_users_for_campaign(
                session,
                is_subscribed=True,
                last_activity_before=datetime.utcnow() - timedelta(days=7)
            )
        return []

    async def _create_campaign(
        self,
        session: AsyncSession,
        campaign_type: CampaignType,
        target_count: int
    ):
        """–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –∫–∞–º–ø–∞–Ω–∏–∏"""
        # TODO: Implement Campaign model and CRUD
        pass

    async def _update_campaign_stats(
        self,
        session: AsyncSession,
        campaign_id: int,
        sent_count: int
    ):
        """–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–º–ø–∞–Ω–∏–∏"""
        # TODO: Update campaign stats
        pass
```

### 1.2 Database Models –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫

**–î–æ–±–∞–≤–∏—Ç—å –≤:** `src/database/models.py`

```python
class Campaign(Base):
    """–ö–∞–º–ø–∞–Ω–∏–∏ —Ä–∞—Å—Å—ã–ª–æ–∫"""
    __tablename__ = "campaigns"

    id = Column(Integer, primary_key=True)
    campaign_type = Column(String, nullable=False)  # CampaignType enum
    created_at = Column(DateTime, default=datetime.utcnow)
    scheduled_for = Column(DateTime, nullable=True)
    executed_at = Column(DateTime, nullable=True)

    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    target_count = Column(Integer, default=0)  # –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
    sent_count = Column(Integer, default=0)    # –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
    delivered_count = Column(Integer, default=0)  # –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
    clicked_count = Column(Integer, default=0)    # –ö–ª–∏–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏)

    # –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
    message_template = Column(Text)

    # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
    status = Column(String, default="pending")  # pending|executing|completed|failed


class CampaignClick(Base):
    """–ö–ª–∏–∫–∏ –ø–æ —Å—Å—ã–ª–∫–∞–º –≤ —Ä–∞—Å—Å—ã–ª–∫–∞—Ö"""
    __tablename__ = "campaign_clicks"

    id = Column(Integer, primary_key=True)
    campaign_id = Column(Integer, ForeignKey("campaigns.id"))
    user_id = Column(Integer, ForeignKey("users.id"))
    clicked_at = Column(DateTime, default=datetime.utcnow)
    link_type = Column(String)  # platform|channel|analyze

    # –ö–æ–Ω–≤–µ—Ä—Å–∏—è
    converted = Column(Boolean, default=False)  # –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
```

### 1.3 CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏

**–î–æ–±–∞–≤–∏—Ç—å –≤:** `src/database/crud.py`

```python
async def get_users_for_campaign(
    session: AsyncSession,
    is_subscribed: Optional[bool] = None,
    last_activity_before: Optional[datetime] = None,
    last_activity_after: Optional[datetime] = None,
    created_before: Optional[datetime] = None,
    created_after: Optional[datetime] = None
) -> List[User]:
    """–ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏"""
    query = select(User)

    if is_subscribed is not None:
        query = query.where(User.is_subscribed == is_subscribed)

    if last_activity_before:
        query = query.where(User.last_activity < last_activity_before)

    if last_activity_after:
        query = query.where(User.last_activity > last_activity_after)

    if created_before:
        query = query.where(User.created_at < created_before)

    if created_after:
        query = query.where(User.created_at > created_after)

    result = await session.execute(query)
    return result.scalars().all()
```

---

## –≠–¢–ê–ü 2: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫

> **–û—Ü–µ–Ω–∫–∞:** 5-8 —á–∞—Å–æ–≤
> **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** HIGH - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏

### 2.1 –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

**–§–∞–π–ª:** `src/bot/handlers/admin.py`

```python
from aiogram import Router, F
from aiogram.types import Message, CallbackQuery
from aiogram.filters import Command

from src.services.retention_service import RetentionService, CampaignType
from config.config import ADMIN_IDS

router = Router()


@router.message(Command("admin"))
async def admin_panel(message: Message):
    """–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å"""
    if message.from_user.id not in ADMIN_IDS:
        return

    text = """üîß **–ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨**

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
/admin_stats - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞

üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
/admin_users - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
/admin_user <id> - –î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

üí∏ –†–∞—Å—Ö–æ–¥—ã:
/admin_costs - –†–∞—Å—Ö–æ–¥—ã –Ω–∞ API

üì® –†–∞—Å—Å—ã–ª–∫–∏:
/admin_broadcast - –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
/admin_campaigns - –ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Å—ã–ª–æ–∫

‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
/admin_limits <user_id> <new_limit> - –ò–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç
/admin_reset <user_id> - –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã"""

    await message.answer(text, parse_mode="Markdown")


@router.message(Command("admin_broadcast"))
async def admin_broadcast(message: Message, retention_service: RetentionService):
    """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
    if message.from_user.id not in ADMIN_IDS:
        return

    # TODO: Interactive flow –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å—Å—ã–ª–∫–∏
    # 1. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø (–ø—Ä–æ–º–æ, feature, market update)
    # 2. –í—ã–±—Ä–∞—Ç—å –∞—É–¥–∏—Ç–æ—Ä–∏—é (–≤—Å–µ, –∞–∫—Ç–∏–≤–Ω—ã–µ, –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
    # 3. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç
    # 4. –í—ã–±—Ä–∞—Ç—å –≤—Ä–µ–º—è (—Å–µ–π—á–∞—Å –∏–ª–∏ –æ—Ç–ª–æ–∂–∏—Ç—å)
    # 5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

    text = """üì® **–°–û–ó–î–ê–ù–ò–ï –†–ê–°–°–´–õ–ö–ò**

**–®–∞–≥ 1/5: –¢–∏–ø —Ä–∞—Å—Å—ã–ª–∫–∏**

–í—ã–±–µ—Ä–∏ —Ç–∏–ø:
1Ô∏è‚É£ –ü—Ä–æ–º–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Syntra
2Ô∏è‚É£ –ù–æ–≤–∞—è —Ñ–∏—á–∞
3Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞
4Ô∏è‚É£ –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª

–û—Ç–ø—Ä–∞–≤—å –Ω–æ–º–µ—Ä (1-4)"""

    await message.answer(text, parse_mode="Markdown")


@router.message(Command("admin_stats"))
async def admin_stats(message: Message, session: AsyncSession):
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞"""
    if message.from_user.id not in ADMIN_IDS:
        return

    # –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–∑ –ë–î
    total_users = await get_total_users(session)
    subscribed = await get_subscribed_users_count(session)
    active_today = await get_active_users_count(session, days=1)
    active_week = await get_active_users_count(session, days=7)

    text = f"""üìä **–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–û–¢–ê**

üë• **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
‚Ä¢ –í—Å–µ–≥–æ: {total_users}
‚Ä¢ –ü–æ–¥–ø–∏—Å–∞–Ω—ã: {subscribed} ({subscribed/total_users*100:.1f}%)
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã —Å–µ–≥–æ–¥–Ω—è: {active_today}
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã –∑–∞ –Ω–µ–¥–µ–ª—é: {active_week}

üí¨ **–ó–∞–ø—Ä–æ—Å—ã:**
‚Ä¢ –°–µ–≥–æ–¥–Ω—è: {await get_requests_count(session, days=1)}
‚Ä¢ –ó–∞ –Ω–µ–¥–µ–ª—é: {await get_requests_count(session, days=7)}

üí∞ **–†–∞—Å—Ö–æ–¥—ã (OpenAI):**
‚Ä¢ –°–µ–≥–æ–¥–Ω—è: ${await get_costs(session, days=1):.2f}
‚Ä¢ –ó–∞ –Ω–µ–¥–µ–ª—é: ${await get_costs(session, days=7):.2f}
‚Ä¢ –ó–∞ –º–µ—Å—è—Ü: ${await get_costs(session, days=30):.2f}

üì® **–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏:**
{await get_recent_campaigns_summary(session)}"""

    await message.answer(text, parse_mode="Markdown")


@router.message(Command("admin_campaigns"))
async def admin_campaigns(message: Message, session: AsyncSession):
    """–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Å—ã–ª–æ–∫"""
    if message.from_user.id not in ADMIN_IDS:
        return

    campaigns = await get_recent_campaigns(session, limit=10)

    text = "üì® **–ò–°–¢–û–†–ò–Ø –†–ê–°–°–´–õ–û–ö**\n\n"

    for camp in campaigns:
        text += f"""**{camp.campaign_type}**
üìÖ {camp.created_at.strftime('%d.%m.%Y %H:%M')}
üìä –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {camp.sent_count}/{camp.target_count}
üëÜ –ö–ª–∏–∫–∏: {camp.clicked_count} ({camp.clicked_count/camp.sent_count*100:.1f}% CTR)
---
"""

    await message.answer(text, parse_mode="Markdown")
```

---

## –≠–¢–ê–ü 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π Syntra

### 3.1 –¢—Ä–µ–∫–∏–Ω–≥ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

**–¶–µ–ª—å:** –ü–æ–Ω—è—Ç—å –∫–∞–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—à–ª–∏ —Å –±–æ—Ç–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

**–†–µ—à–µ–Ω–∏–µ:** UTM-–º–µ—Ç–∫–∏ –≤ —Å—Å—ã–ª–∫–∞—Ö

```python
# config/config.py
SYNTRA_PLATFORM_URL = "https://syntratrade.com"

def get_platform_link(user_id: int, source: str = "bot") -> str:
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ —Å —Ç—Ä–µ–∫–∏–Ω–≥–æ–º"""
    return f"{SYNTRA_PLATFORM_URL}?utm_source=telegram_bot&utm_medium=ai_consultant&utm_campaign={source}&ref={user_id}"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞—Å—Å—ã–ª–∫–∞—Ö:**
```python
message = f"""üëâ [–ù–∞—á–∞—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å]({get_platform_link(user.id, 'broadcast_platform_promo')})"""
```

**–ù–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å `ref={user_id}` –∏ —Å–≤—è–∑—ã–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–æ—Ç–∞.

### 3.2 Database sync

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π

```python
# –í–∞—Ä–∏–∞–Ω—Ç 1: Webhook –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
# –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ ‚Üí –≤–µ–±—Ö—É–∫ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Campaign.converted = True

# –í–∞—Ä–∏–∞–Ω—Ç 2: Shared Database
# –û–±—â–∞—è ÔøΩÔøΩ–∞–±–ª–∏—Ü–∞ –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (–µ—Å–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ)

# –í–∞—Ä–∏–∞–Ω—Ç 3: API sync
# –ë–æ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á–µ—Ä–µ–∑ API –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∫—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è
```

### 3.3 Cross-promotion

**–í –±–æ—Ç–µ Syntra Trade Consultant:**
- –†–∞—Å—Å—ã–ª–∫–∏ –ø—Ä–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
- –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å" –≤ /start
- –ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞ –¥–µ–ø–æ–∑–∏—Ç –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ

**–í Telegram –±–æ—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (tradient-ai):**
- –ö–Ω–æ–ø–∫–∞ "AI –ê–Ω–∞–ª–∏—Ç–∏–∫" ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ Syntra Trade Consultant
- –£–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Ä–∞—Å—Å—ã–ª–∫–∞—Ö: "–•–æ—á–µ—à—å AI-—Å–æ–≤–µ—Ç—ã? –ü–æ–ø—Ä–æ–±—É–π –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞"

**–í –∫–∞–Ω–∞–ª–µ Syntra:**
- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π –ø–æ—Å—Ç —Å –æ–±–æ–∏–º–∏ –±–æ—Ç–∞–º–∏
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

---

## –≠–¢–ê–ü 4: –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### 4.1 –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**Funnel metrics (–¥–æ–±–∞–≤–∏—Ç—å –≤ –∞–¥–º–∏–Ω–∫—É):**

```python
async def get_funnel_stats(session: AsyncSession) -> dict:
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏"""
    total_users = await get_total_users(session)
    subscribed = await get_subscribed_users_count(session)
    clicked_platform = await get_platform_clicks_count(session)
    converted = await get_converted_users_count(session)  # –¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π

    return {
        "total_users": total_users,
        "subscribed": subscribed,
        "subscription_rate": subscribed / total_users if total_users > 0 else 0,

        "clicked_platform": clicked_platform,
        "click_rate": clicked_platform / subscribed if subscribed > 0 else 0,

        "converted": converted,
        "conversion_rate": converted / clicked_platform if clicked_platform > 0 else 0,

        "overall_conversion": converted / total_users if total_users > 0 else 0
    }
```

### 4.2 A/B Testing —Ä–∞—Å—Å—ã–ª–æ–∫

```python
class ABTest:
    """A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π"""

    async def split_test_broadcast(
        self,
        variant_a: str,
        variant_b: str,
        audience: List[User],
        split_ratio: float = 0.5
    ):
        """
        –†–∞–∑–±–∏—Ç—å –∞—É–¥–∏—Ç–æ—Ä–∏—é –Ω–∞ 2 –≥—Ä—É–ø–ø—ã –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

        –ó–∞—Ç–µ–º —Å—Ä–∞–≤–Ω–∏—Ç—å CTR –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—é
        """
        import random

        random.shuffle(audience)
        split_point = int(len(audience) * split_ratio)

        group_a = audience[:split_point]
        group_b = audience[split_point:]

        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
        for user in group_a:
            await self._send_message(user.telegram_id, variant_a)

        for user in group_b:
            await self._send_message(user.telegram_id, variant_b)

        # –¢—Ä–µ–∫–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        # ...
```

---

## –≠–¢–ê–ü 5: –ó–∞–ø—É—Å–∫ –≤ production

### 5.1 Pre-launch checklist

- [ ] Retention service —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≥–æ—Ç–æ–≤–∞
- [ ] Database models —Å–æ–∑–¥–∞–Ω—ã (Campaign, CampaignClick)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] UTM-—Ç—Ä–µ–∫–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –¢–µ—Å—Ç–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞
- [ ] Error monitoring (Sentry) –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] Backup –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### 5.2 Soft Launch (Beta)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:**
1. **–ù–µ–¥–µ–ª—è 1:** 50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥—Ä—É–∑—å—è, –∑–Ω–∞–∫–æ–º—ã–µ)
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
   - –°–±–æ—Ä —Ñ–∏–¥–±–µ–∫–∞
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫

2. **–ù–µ–¥–µ–ª—è 2:** 200 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü–µ—Ä–≤–∞—è –∞–≤—Ç–æ-—Ä–∞—Å—Å—ã–ª–∫–∞ (inactive_24h)
   - –ê–Ω–∞–ª–∏–∑ retention metrics
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

3. **–ù–µ–¥–µ–ª—è 3:** 500 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü–µ—Ä–≤–∞—è –ø—Ä–æ–º–æ-—Ä–∞—Å—Å—ã–ª–∫–∞ –ø—Ä–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
   - –ò–∑–º–µ—Ä–µ–Ω–∏–µ conversion rate
   - A/B —Ç–µ—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏–π

4. **–ù–µ–¥–µ–ª—è 4:** –ü—É–±–ª–∏—á–Ω—ã–π –∑–∞–ø—É—Å–∫
   - –û—Ç–∫—Ä—ã—Ç—å –¥–ª—è –≤—Å–µ—Ö
   - –†–µ–∫–ª–∞–º–∞ –≤ –∫—Ä–∏–ø—Ç–æ-–∫–∞–Ω–∞–ª–∞—Ö
   - –ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞

### 5.3 Growth channels

**Organic:**
- Telegram –ø–æ–∏—Å–∫ (keywords: "–∫—Ä–∏–ø—Ç–æ AI", "bitcoin –∞–Ω–∞–ª–∏—Ç–∏–∫–∞")
- –£–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ Syntra
- Word of mouth

**Paid:**
- –†–µ–∫–ª–∞–º–∞ –≤ –∫—Ä–∏–ø—Ç–æ-–∫–∞–Ω–∞–ª–∞—Ö (CPA $2-5)
- Telegram Ads (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
- –ò–Ω—Ñ–ª—é–µ–Ω—Å–µ—Ä—ã (crypto YouTubers/Telegram –∫–∞–Ω–∞–ª—ã)

**Partnerships:**
- Cross-promotion —Å –¥—Ä—É–≥–∏–º–∏ –∫—Ä–∏–ø—Ç–æ-–±–æ—Ç–∞–º–∏
- –£–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ –∫—Ä–∏–ø—Ç–æ-–º–µ–¥–∏–∞
- –õ–∏—Å—Ç–∏–Ω–≥–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–∞—Ö –±–æ—Ç–æ–≤

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 2 –Ω–µ–¥–µ–ª–∏

### –ù–µ–¥–µ–ª—è 1: Core Implementation

**–î–µ–Ω—å 1-2: Retention Service**
- [ ] –°–æ–∑–¥–∞—Ç—å `src/services/retention_service.py`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏ (1h, 24h, 7d)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ-—Ä–∞—Å—Å—ã–ª–∫–∏
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —à–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π

**–î–µ–Ω—å 3-4: Database & Admin**
- [ ] –î–æ–±–∞–≤–∏—Ç—å Campaign, CampaignClick models
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã (/admin_broadcast, /admin_campaigns)
- [ ] –î–æ–±–∞–≤–∏—Ç—å funnel stats –≤ /admin_stats

**–î–µ–Ω—å 5-7: Testing & Polish**
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å error handling
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è retention service

### –ù–µ–¥–µ–ª—è 2: Integration & Launch

**–î–µ–Ω—å 8-9: Platform Integration**
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å UTM-—Ç—Ä–µ–∫–∏–Ω–≥
- [ ] –î–æ–±–∞–≤–∏—Ç—å tracking links –≤–æ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π (webhook –∏–ª–∏ API)

**–î–µ–Ω—å 10-12: Soft Launch**
- [ ] Deploy –Ω–∞ production
- [ ] –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å 50 beta-—Ç–µ—Å—Ç–µ—Ä–æ–≤
- [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –∞–≤—Ç–æ-—Ä–∞—Å—Å—ã–ª–∫—É
- [ ] –°–æ–±—Ä–∞—Ç—å —Ñ–∏–¥–±–µ–∫

**–î–µ–Ω—å 13-14: Optimization**
- [ ] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ A/B —Ç–µ—Å—Ç
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ –ø—É–±–ª–∏—á–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ü–æ—Å–ª–µ 1 –º–µ—Å—è—Ü–∞ —Ä–∞–±–æ—Ç—ã (–ø—Ä–∏ 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞ | 1000 |
| –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∫–∞–Ω–∞–ª–∞ | 950 (95%) |
| –ö–ª–∏–∫–æ–≤ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É | 100-150 (10-15%) |
| –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π | 30-60 (3-6% –æ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤) |
| –î–µ–ø–æ–∑–∏—Ç–æ–≤ | 5-10 (0.5-1% –æ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤) |
| **Revenue from deposits** | **$250-500** (–ø—Ä–∏ avg deposit $50) |
| **OpenAI costs** | **~$120/month** |
| **Net profit** | **$130-380** |
| **ROI** | **+108-316%** |

**Scaling –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª:**
- 10,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Üí 50-100 –¥–µ–ø–æ–∑–∏—Ç–æ–≤ ‚Üí **$2,500-5,000/month revenue**
- 100,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Üí 500-1000 –¥–µ–ø–æ–∑–∏—Ç–æ–≤ ‚Üí **$25,000-50,000/month revenue**

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Syntra Trade Consultant** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π traffic funnel –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Syntra.

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Retention Service (5-10 —á–∞—Å–æ–≤)
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫ (5-8 —á–∞—Å–æ–≤)
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π (3-5 —á–∞—Å–æ–≤)
4. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å beta-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (50 —é–∑–µ—Ä–æ–≤)
5. üìä –ò–∑–º–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –æ–ø—Ç–∏–ºÔøΩÔøΩ–∑–∏—Ä–æ–≤–∞—Ç—å
6. üéØ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å

**Estimated time to launch:** 2 –Ω–µ–¥–µ–ª–∏ (40-60 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã)

**Expected ROI:** 10-40x –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ç—Ä–∞—Ñ—Ñ–∏–∫–∞

---

**–î–∞—Ç–∞:** 2025-11-18
**–í–µ—Ä—Å–∏—è:** 1.0
**–ê–≤—Ç–æ—Ä:** Claude (AI Development Assistant)
